% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/nanostring_YL_functions.R
\name{QC_plus_nSolver_processing}
\alias{QC_plus_nSolver_processing}
\title{QC_plus_nSolver_processing}
\usage{
QC_plus_nSolver_processing(
  guide_vect,
  ref_name,
  remove_failed_HK = FALSE,
  background_correction = TRUE,
  controls_only_norm = FALSE
)
}
\arguments{
\item{guide_vect}{A vector with the files to read in as values (including the path)
and the associated group of each file as the name in the vector.}

\item{ref_name}{The group name to be used as the reference/control.}

\item{remove_failed_HK}{Boolean indicating if housekeeping genes correlating
with the condition should be removed from the downstream analysis. By default
it is set to FALSE.}

\item{background_correction}{Boolean indicating whether to apply background
correction using mean + 2SD of negative controls, as per nSolver defaults.
Default is TRUE.}

\item{controls_only_norm}{Boolean. When TRUE, normalization factors (positive
control and housekeeping scaling) are computed using only the reference/control
samples and then applied to all samples. This ensures patient samples do not
influence each other's normalization and that each patient is always scaled
against the same fixed control reference, regardless of how many patient
samples are processed together. Default is FALSE (all samples contribute to
the global reference, matching standard NanoStringNorm behaviour).}
}
\value{
A list containing:
\itemize{
  \item \code{normalized_counts}: A gene x sample matrix of nSolver-normalized counts
  \item \code{QCdata}: A data frame containing QC metrics for each sample
}
}
\description{
This function reads in RCC (nanostring) files, performs a set of quality controls,
and normalizes the data using nSolver-equivalent normalization via NanoStringNorm.
Normalization applies positive control scaling (geometric mean) followed by
housekeeping gene scaling (geometric mean), matching the default nSolver workflow.
Depending on the parameter settings the function will also remove/filter out
housekeeping genes which are found to correlate with the condition.
}
\author{
Yohan Lefol
}
